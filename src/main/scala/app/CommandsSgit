package app

import java.io.File
import java.nio.file.Paths

object CommandsSgit {


  /*
  INIT -----------
   */
  def init() : Unit = {
    FileIO.initSgitRepository()
  }
  /*
  --------------
   */


  /*
 ADD -----------
  */
  def add(args: Array[String]) : Unit = {
    if (args.length == 1) println("You need to specify a folder or a file")
    else if(args.length == 2 && args(1).equals(".")) {
      val path = Paths.get("")
    else {
args.filter(_ != "add").map(arg =>{

  addRoutine(arg)
})
    }


  }

  def addRoutine(f: File) : Unit = {
    if(f.isFile){
      FileIO.createBlob(f)
    }else{
      recursionFiles(f, new Tree())
    }
  }


  def recursionFiles(f: File, currentTree: Tree): Unit = {
    val path = f.getCanonicalPath
    val listOfFiles = FileManager.getListOfAll(path)

    listOfFiles.map(elem =>{
      if(elem.isDirectory){
        val newTree = new Tree()

        recursionFiles(elem, newTree)

        //AddTree
        val newContent = s"Tree ${newTree.get_idTree()} ${elem.getName}"
        currentTree.set_contentTree(currentTree.addContentTree(newContent))

      }else{

       val blob = FileIO.createBlob(elem)
       currentTree.set_contentTree(currentTree.addContentTree(blob))
        println(elem)
      }
    })


    // Tree part
    currentTree.createId()
    FileIO.addTree(currentTree.get_idTree(),currentTree.get_contentTree())




  }
  /*
  --------------
   */

}